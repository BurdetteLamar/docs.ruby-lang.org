#!/usr/bin/env ruby

VERSIONS = %w[
  2.2.0
  2.3.0
  2.4.0
  trunk
]

DOC_ROOT = "/var/www/docs.ruby-lang.org/shared/public/en"

Dir.chdir(File.join(__dir__, '..'))

def create_document(version)
  system("bundle", "exec", "rake", "update:#{version}") or raise
  system("bundle", "exec", "rake", "rdoc:clobber_en/#{version}") or raise
  system("bundle", "exec", "rake", "rdoc:en/#{version}") or raise
  system("rm", "-rf", "#{DOC_ROOT}/#{version}") or raise
  system("mv", version, DOC_ROOT) or raise
  puts "#{version} is done."
end

VERSIONS.reverse_each do |version|
  create_document(version)
end
